<!DOCTYPE html><html lang="en"><!-- Head tag --><head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">



    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
    <!-- Bootstrap -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <!--Tiny bird analytics-->

    <!-- background image -->
    <link rel="preload" href="/img/bg.webp" as="image" fetchpriority="high">

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"> 
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- Gallery -->
    <!-- <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/> -->


    <!--Description-->
    

    
        <meta name="description" content="My incoherent ramblings">
        <meta property="og:description" content="My incoherent ramblings">
        <meta name="twitter:description" content="My incoherent ramblings">
    

    <!--Author-->
    
        <meta name="author" content="Lukas">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Waltzing With Chance">
        <meta name="twitter:title" content="Waltzing With Chance">
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Lukas's Blog">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://loreley.one/img/bg.webp">
        <meta name="twitter:image" content="http://loreley.one/img/bg.webp">
    

        <meta name="twitter:card" content="summary_large_image">

    
        <meta name="twitter:site" content="@LukasBogacz">
    

    
        <meta name="twitter:image" content="http://loreley.one/img/bg.webp">
    

    <!-- Title -->
    
    <title>Waltzing With Chance - Lukas's Blog</title>

    <!-- favicon -->
    
        <link rel="icon" href="/img/favicon.ico">
        
    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-custom navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Home</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/about">
                            
                                About
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/links">
                            
                                Links
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://github.com/BasedLukas">
                            
                                <i class="fa fa-stack-2x fa-github"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image:url(/img/bg.webp)">
    <div class="container">
        <div class="row">
            <div class="col-md-offset-1 col-lg-offset-1 col-md-10 col-lg-8">
                <div class="post-heading">
                    <h1>Waltzing With Chance</h1>
                    
                    <h2 class="post-subheading">
                        A brief introduction to Monte Carlo simulations in python.
                    </h2>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Posted by Lukas on
                        
                        
                            2023-06-30
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-md-offset-1 col-lg-offset-1 col-lg-4 col-md-5 post-tags">
                    
                        


<a href="/tags/python/">#python</a> <a href="/tags/probability/">#probability</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-md-offset-1 col-lg-offset-1 col-md-10 col-lg-10">
                <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Suppose you were flying over the Pacific and suffered a plane crash. Luckily you survived the crash and are now stranded on a deserted island. Unfortunately, you struck your head quite badly and can no longer recall the value for pi. All you have with you is a short stick, a stone and your wits to guide you. Naturally you are concerned with the most pressing problem, viz. calculating the value of pi, which you have forgotten. How can you go about doing so?<br>Luckily for you, there exists a solution to this problem – the Monte Carlo simulation.</p>
<h2 id="The-Setup"><a href="#The-Setup" class="headerlink" title="The Setup"></a>The Setup</h2><p>Lets start by creating a square with sides the length of the stick “r” in the sand. Next create a circle with a radius of “r”. We can make the following statements;</p>
<p>The area of the circle =  <code>Π × r²</code></p>
<p>The area of the square =  <code>r²</code></p>
<p>Thus;</p>
<p>area of the circle / area of the square =</p>
<p><code>Π × r² / r²  = Π</code></p>
<p>All we have to do is calculate the area of the circle and the square and we can calculate pi. Unfortunately, that is quite difficult to do. Cue the Monte Carlo simulation.</p>
<h2 id="The-Simulation"><a href="#The-Simulation" class="headerlink" title="The Simulation"></a>The Simulation</h2>
<center>
<img src="setup.webp" alt="setup" fetchpriority="high" decoding="async" width="300" height="300"> 
</center> 


<p>Steps:</p>
<ul>
<li>Take the stone</li>
<li>Throw it up</li>
<li>Each time the stone lands make a note of whether it landed in the circle or square.</li>
</ul>
<p>Suppose you did this a few thousand times. Your final results would look something like this;</p>
<p>circle =  <code>1591</code><br>square =  <code>491</code></p>
<p>You can use the number of times that the stone fell inside the shape as a proxy for the area of the shape. This is the heart of a Monte Carlo simulation – using a random process to estimate some value. You can now calculate pi by simply dividing the one by the other. </p>
<p>To clarify, what we are doing here is estimating the area of a shape. This works because the probability that the stone will fall inside the shape is equal to the area of the shape.</p>
<h2 id="Simulation-in-Python"><a href="#Simulation-in-Python" class="headerlink" title="Simulation in Python"></a>Simulation in Python</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of points that landed in the circle or square</span></span><br><span class="line">in_circle = <span class="number">0</span></span><br><span class="line">in_square = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of iterations</span></span><br><span class="line">iterations = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># the radius of the circle and side of the square</span></span><br><span class="line">r = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">    <span class="comment"># randomly select 2 points between 0-20</span></span><br><span class="line">    x = random.uniform(<span class="number">0</span>, <span class="number">20</span>)</span><br><span class="line">    y = random.uniform(<span class="number">0</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if point (x,y) is in square (x &lt; r and y &lt; r) (bottom left corner of square is at the origin)</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; r <span class="keyword">and</span> y &lt; r:</span><br><span class="line">        in_square += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># calculate the distance between point(x,y) and center of circle (r,r)</span></span><br><span class="line">    distance = math.sqrt((r - x)**<span class="number">2</span> + (r - y)**<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># check if point (x, y) is in circle.</span></span><br><span class="line">    <span class="keyword">if</span> distance &lt; r:</span><br><span class="line">        in_circle += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">1000</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pi = in_circle / in_square</span><br><span class="line">        <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">            pi = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'Estimated value of pi after'</span>,i,<span class="string">'iterations is'</span>,pi)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">Estimated value of pi after 0 iterations is 0</span><br><span class="line">Estimated value of pi after 1000 iterations is 2.7627737226277373</span><br><span class="line">Estimated value of pi after 2000 iterations is 2.911985018726592</span><br><span class="line">Estimated value of pi after 3000 iterations is 2.8870967741935485</span><br><span class="line">Estimated value of pi after 4000 iterations is 2.890334572490706</span><br><span class="line">Estimated value of pi after 5000 iterations is 2.951367781155015</span><br><span class="line">Estimated value of pi after 6000 iterations is 2.996168582375479</span><br><span class="line">Estimated value of pi after 7000 iterations is 3.0482796892341844</span><br><span class="line">Estimated value of pi after 8000 iterations is 3.040658276863504</span><br><span class="line">Estimated value of pi after 9000 iterations is 3.0583657587548636</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">Estimated value of pi after 1999000000 iterations is 3.1414178257741354</span><br></pre></td></tr></tbody></table></figure>

<p>Here is a plot of the points. The points that landed in the circle are red and orange. Those that landed in the square are blue and orange, and those that landed in neither are green. (Note that it makes no difference if the circle overlaps with the square, we merely want to estimate the area of each shape.)</p>

<center> 
<img src="pi.webp" alt="pi" loading="lazy" decoding="async" width="300" height="300">
</center>


<p>And now for a graph of the estimated value of pi by iteration. This graph nicely illustrates the law of large numbers. In the beginning our estimate is wildly off. Over time it converges toward pi.</p>

<center> 
<img src="estimation.webp" alt="setup" loading="lazy" decoding="async" width="705" height="425">
</center>


<h2 id="Snakes-and-ladders"><a href="#Snakes-and-ladders" class="headerlink" title="Snakes and ladders"></a>Snakes and ladders</h2><p>Suppose you bet on a game of snakes and ladders against somebody. Your opponent keeps winning and you suspect him of cheating. You want to calculate the probability of him finishing the game in a certain number of moves or less (you cannot remember what his dice rolls were, only the number of turns it took him to win). In order to do this you need to create a distribution of the number of moves it takes to finish the game.</p>
<p>The game works as follows;</p>
<ul>
<li>The players start at position 0</li>
<li>Each player rolls a 6 sided die</li>
<li>The player moves forward by the number rolled.</li>
<li>If the landing square is the base of a ladder, the player is transported to the top.</li>
<li>If the landing square is the top of a snake, the player is transported to the bottom.</li>
</ul>
<p>Calculating the distribution of the number of rolls it takes to complete the game could be quite complex. (This is called a Markov chain and can be solved algebraically). Instead we can simulate the game by randomly generating dice rolls and counting how many rolls it takes to complete the game. Doing this multiple times gives us the distribution.</p>
<h2 id="Simulation-in-Python-1"><a href="#Simulation-in-Python-1" class="headerlink" title="Simulation in Python"></a>Simulation in Python</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment">#Number of iterations to simulate</span></span><br><span class="line">iterations = <span class="number">100000</span></span><br><span class="line"></span><br><span class="line">game = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">51</span>)]</span><br><span class="line"><span class="comment">#ladders</span></span><br><span class="line">game[<span class="number">2</span>] = <span class="number">15</span></span><br><span class="line">game[<span class="number">5</span>] = <span class="number">17</span></span><br><span class="line">game[<span class="number">9</span>] = <span class="number">27</span></span><br><span class="line">game[<span class="number">17</span>] = <span class="number">41</span></span><br><span class="line">game[<span class="number">25</span>] = <span class="number">35</span></span><br><span class="line">game[<span class="number">34</span>] = <span class="number">48</span></span><br><span class="line"><span class="comment">#snakes</span></span><br><span class="line">game[<span class="number">33</span>] = <span class="number">20</span></span><br><span class="line">game[<span class="number">30</span>] = <span class="number">10</span></span><br><span class="line">game[<span class="number">20</span>] = <span class="number">1</span></span><br><span class="line">game[<span class="number">49</span>] = <span class="number">36</span></span><br><span class="line">game[<span class="number">18</span>] = <span class="number">8</span></span><br><span class="line">game[<span class="number">40</span>] = <span class="number">6</span></span><br><span class="line">game[<span class="number">26</span>] = <span class="number">19</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># the number of rolls it takes to win the game</span></span><br><span class="line">rolls = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="function_ title">simulate_game</span>():</span><br><span class="line">    <span class="comment"># start at square 0</span></span><br><span class="line">    player1 = <span class="number">0</span></span><br><span class="line">    number_of_rolls = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># simulate a roll of the die</span></span><br><span class="line">        roll = random.randint(<span class="number">1</span>,<span class="number">6</span>)</span><br><span class="line">        <span class="comment"># count how many rolls the player has taken</span></span><br><span class="line">        number_of_rolls += <span class="number">1</span></span><br><span class="line">        <span class="comment"># move forward by the number rolled</span></span><br><span class="line">        player1 += roll</span><br><span class="line">        <span class="comment"># Stop once the player reaches square 50</span></span><br><span class="line">        <span class="keyword">if</span> player1 &gt;= <span class="number">50</span>:</span><br><span class="line">            <span class="keyword">return</span> number_of_rolls</span><br><span class="line">        <span class="comment"># if the player lands on a snake or ladder, move accordingly</span></span><br><span class="line">        player1 = game[player1]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">    rolls.append(simulate_game())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#plot distribution of rolls</span></span><br><span class="line">plt.hist(rolls, bins=<span class="number">100</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>

<center> 
<img src="results.webp" alt="results" loading="lazy" decoding="async" width="1024" height="383">
</center>


<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Monte Carlo simulations are a simple but powerful tool for estimating unknown values. They are especially helpful if you don’t know probability theory (like me) and just want to know the odds of some event occurring. <a target="_blank" rel="noopener" href="https://library.lanl.gov/cgi-bin/getfile?00326866.pdf">This article</a> (PDF) talks about how the first Monte Carlo simulations were used in the Manhattan project. If you would like to learn more about Markov chains, <a target="_blank" rel="noopener" href="https://math.libretexts.org/Bookshelves/Applied_Mathematics/Applied_Finite_Mathematics_%28Sekhon_and_Bloom%29/10%3A_Markov_Chains/10.01%3A_Introduction_to_Markov_Chains">this article</a> is a good place to start. Creating simple simulations in python is relatively straightforward and fun.<br>I hope you get rescued from that island soon!</p>


                
            </div>

        </div>
    </div>
</article>

    <!-- Footer -->
    <hr>

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-offset-1 col-md-10 col-lg-8 col-lg-offset-2">
                <ul class="list-inline text-center">
                    

                    

                    

                    

                    
                        <li>
                            <a href="mailto:info@loreley.one" target="_blank">
                                <span class="fa-lg fa-stack">
                                    <i class="fa fa-stack-2x fa-circle"></i>
                                    <i class="fa fa-envelope-o fa-inverse fa-stack-1x"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">© 2024 Lukas<br></p>



                
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    

<script defer="" src="/js/analytics.js" data-host="https://api.tinybird.co" data-token="p.eyJ1IjogImYxMGY0NmY5LWI2MTQtNGY3Mi1hNWRkLTJkZWMyZTYzOGU0ZCIsICJpZCI6ICJmM2Y3MDk5Ny03YTZiLTRlYzUtYTdkNC01ZTVkMmY1ZjZjMDcifQ.uBS7CItgVesD7IqUpKSyA_g6UNTH-YHuH3-XfpWy1o0"></script>






</body></html>