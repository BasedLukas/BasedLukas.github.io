(function(){"use strict";function u(){var n=document.querySelectorAll("figure.highlight");n.forEach(function(e){if(!e.closest(".code-block")){for(var t="",o=e.className.split(/\s+/),s=0;s<o.length;s++)if(o[s]!=="highlight"){t=o[s];break}var r=document.createElement("div");r.className="code-block";var d=document.createElement("div");d.className="code-header";var a=document.createElement("span");a.className="code-lang",a.textContent=t||"code";var c=document.createElement("button");c.className="code-copy",c.textContent="Copy",c.addEventListener("click",function(){var i=e.querySelector("td.code pre, pre");if(i){var l=i.textContent;navigator.clipboard.writeText(l).then(function(){c.textContent="Copied!",c.classList.add("copied"),setTimeout(function(){c.textContent="Copy",c.classList.remove("copied")},2e3)})}}),d.appendChild(a),d.appendChild(c),e.parentNode.insertBefore(r,e),r.appendChild(d),r.appendChild(e)}})}function f(){var n=document.querySelectorAll(".katex-display");n.forEach(function(e){if(!e.closest(".math-block")){var t=document.createElement("div");t.className="math-block",e.parentNode.insertBefore(t,e),t.appendChild(e)}})}function v(){var n=document.querySelector(".js-post-body");if(n){var e=n.querySelectorAll("table");e.forEach(function(t){if(!(t.closest(".table-wrapper")||t.closest("figure.highlight"))){var o=document.createElement("div");o.className="table-wrapper",t.parentNode.insertBefore(o,t),o.appendChild(t)}})}}function p(){document.addEventListener("click",function(n){var e=n.target.closest('[data-toggle="collapse"]');if(e){n.preventDefault();var t=e.getAttribute("data-target");if(t){var o=document.querySelector(t);o&&o.classList.toggle("is-open")}}})}function h(){var n=window.location.hostname,e=n||"loreley.one",t=document.querySelectorAll("a[href]");t.forEach(function(o){var s=o.getAttribute("href");if(s)try{var r=new URL(s,window.location.origin);if(r.hostname===n||r.hostname===""||r.protocol!=="http:"&&r.protocol!=="https:")return;r.searchParams.has("ref")||(r.searchParams.set("ref",e),o.setAttribute("href",r.toString()))}catch{}})}function m(){var n=document.querySelector(".js-post-body"),e=document.getElementById("toc-list");if(!(!n||!e)){var t=n.querySelectorAll("h2, h3");if(t.length<2){var o=document.querySelector(".toc-sidebar");o&&(o.style.display="none");return}var s=document.createDocumentFragment(),r=[];if(t.forEach(function(a,c){a.id||(a.id="heading-"+c);var i=document.createElement("li");a.tagName==="H3"&&(i.className="toc-h3");var l=document.createElement("a");l.href="#"+a.id,l.textContent=a.textContent,i.appendChild(l),s.appendChild(i),r.push({el:a,link:l})}),e.appendChild(s),"IntersectionObserver"in window){var d=new IntersectionObserver(function(a){a.forEach(function(c){if(c.isIntersecting){r.forEach(function(l){l.link.classList.remove("active")});for(var i=0;i<r.length;i++)if(r[i].el===c.target){r[i].link.classList.add("active");break}}})},{rootMargin:"-80px 0px -60% 0px",threshold:0});r.forEach(function(a){d.observe(a.el)})}}}function g(){if(!("IntersectionObserver"in window)){document.querySelectorAll(".fade-in").forEach(function(e){e.classList.add("visible")});return}var n=new IntersectionObserver(function(e){e.forEach(function(t){t.isIntersecting&&(t.target.classList.add("visible"),n.unobserve(t.target))})},{threshold:.1});document.querySelectorAll(".fade-in").forEach(function(e){n.observe(e)})}function y(){var n=document.querySelector(".nav"),e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav-links");n&&window.addEventListener("scroll",function(){window.scrollY>50?n.classList.add("scrolled"):n.classList.remove("scrolled")},{passive:!0}),e&&t&&(e.addEventListener("click",function(){e.classList.toggle("open"),t.classList.toggle("open")}),t.querySelectorAll("a").forEach(function(o){o.addEventListener("click",function(){e.classList.remove("open"),t.classList.remove("open")})}))}document.addEventListener("DOMContentLoaded",function(){u(),f(),v(),p(),m(),g(),y(),h()})})();
